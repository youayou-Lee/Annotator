# 文书标注系统产品需求文档

## 1. 系统概述
文书标注系统是一个支持多用户协作的在线标注平台，主要用于处理和分析各类文书数据。系统支持文件上传、格式校验、数据标注、复审和数据导出等功能。

## 2. 核心功能

### 2.1 公共文件库部分
- [ ] 对上传的文件进行格式校验，不同文件夹格式限制不同
- [ ] 提供文件预览按键，页面能展示文件大小，修改时间等信息。
- [ ] 支持上传和下载，管理员和超级管理员有所有增删权限，标注人员只有删除自己上传的文件和上传权限。可以单个文件下载，也可以批量下载。
- [ ] 公共文件库建立四个文件夹，包含文档文件（json，jsonl），标注配置文件（json），文件格式文件（py），导出文件（无限制，此文件夹中的数据来源于标注人员处理完的数据）。其中标注配置文件和文件格式文件提供均一个模板文件。且标注人员无法删除。
- [ ] 不同类型的文件放在不同区域，如文档文件就应该只包含json，jsonl文件。

### 2.2 用户管理
- [x] 多用户系统
- [ ] 用户角色：管理员、普通用户、超级用户
- [x] 用户认证和授权
- [ ] 个人信息管理

### 2.3 任务管理
- [ ] 任务创建和分配
  - [ ] 创建流程
    - [ ] 分为三个部分：1.基本信息：任务信息，任务描述，需要标注的文件（可以选择多个）。2. 标注配置：需要标注的字段及其类型（或者提供标注配置的json模板文件）以及验证模板文件（py）。不需要填写标注人员，可在任务创建完毕之后指定标注人员和审核人员，未提及的部分均不需要。
    - [ ] 任务创建需要在公共文件库选择文件，页面展示一个文件列表，显示公共库中的json，jsonl文件。
    - [ ] 标注配置中可以选择自定义需要标注的字段和字段类型。比如数字，bool，数组，字符串等。也可以在公共库中选择对应的标注配置json模板文件。
    - [ ] 标注完进行数据校验（靠py模板文件，py文件中必须提供一个数据校验函数）。
    - [ ] 进行标注之前需要对上传的文件进行格式校验（靠py模板文件，pydantic的basemodel）。前端页面标注过程中填写的数据类型必须被限制和任务配置中的字段类型一致。
  - [ ] 任务分配
    - [ ] 所有人都可以创建任务，但是管理员和超级管理员可以指派给别人，普通标注人员只能给自己创建 
- [ ] 任务展示
  - [ ] 页面展示的数据要可编辑，要和真实数据挂钩，并且支持删除和查看，进度要和真实任务挂钩
- [ ] 任务状态跟踪
- [ ] 任务进度管理



### 2.4 标注功能
- [x] 动态表单生成
- [x] 字段类型验证
- [x] 自定义标注规则
- [x] 实时数据保存
- [x] 标注进度跟踪
- [x] 标注历史记录

### 2.5 复审功能
- [x] 已标注/未标注数据对比
- [x] 差异高亮显示
- [x] 数据修改和更新
- [x] 修改历史记录
- [x] 标注历史按操作类型筛选
- [x] 标注历史按日期范围筛选
- [x] 标注历史排序功能

### 2.6 数据导出
- [x] 支持多种导出格式
- [x] 数据转换接口
- [x] 批量导出功能
- [x] 导出进度跟踪

## 3. 技术规范

### 3.1 文件格式
- [x] 文书文件：JSON/JSONL
- [x] 校验文件：Python (pydantic-v2)
- [x] 导出格式：可扩展

### 3.2 数据验证
- [x] 字段类型检查
- [x] 数值范围验证
- [x] 必填字段验证
- [x] 自定义验证规则

### 3.3 安全性
- [x] 用户认证
- [x] 接口鉴权
- [x] 数据加密
- [x] 防SQL注入
- [x] 防XSS攻击

### 3.4 性能
- [x] 并发处理
- [x] 大数据量处理
- [x] 响应时间优化
- [x] 资源占用监控

## 4. 用户界面

### 4.1 总体风格
- [x] 响应式设计
- [x] 主题切换
- [x] 布局可调整

### 4.2 数据展示
- [x] 表格视图
- [x] 卡片视图
- [x] 图表视图

### 4.3 操作交互
- [x] 拖拽操作
- [x] 快捷键
- [x] 右键菜单

## 5. 扩展功能

### 5.1 已规划功能
- [x] 数据统计分析
- [x] 标注质量评估
- [x] API接口
- [x] 批量导入导出
- [ ] 团队协作功能

### 5.2 未来规划
- [ ] 离线工作模式
- [ ] 多语言支持
- [ ] AI辅助标注
- [ ] 支持新的文件格式 