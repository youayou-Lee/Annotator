# 文书标注系统开发提示词指南

## 📋 开发顺序说明

按照以下顺序进行开发，确保每个阶段完成并测试通过后再进行下一阶段：

```
1. 后端基础架构
2. 前端基础架构  
3. 用户认证系统
4. 文件管理功能
5. 任务管理功能
6. 标注功能
7. 复审功能
8. 数据导出功能
```

---

## 🏗️ 第一阶段：后端基础架构

### 提示词1-1：创建FastAPI后端基础架构

```
请根据我的文档帮我创建FastAPI后端项目的完整基础架构。

具体需求：
1. 按照系统设计文档.md中的目录结构创建完整的项目文件
2. 实现所有数据模型（User、Task、Annotation等），严格按照文档中的JSON结构
3. 创建文件系统存储管理器，支持JSON文件的读写操作
4. 实现基本的配置管理（config.py）和依赖注入
5. 创建所有API路由的基础结构（包含所有端点，但暂时返回空响应）
6. 设置CORS、JWT认证中间件和基本的安全配置
7. 创建main.py作为应用入口

技术要求：
- 使用requirements.txt中的所有依赖包
- 严格遵循系统设计文档.md中的数据模型设计
- 实现文件系统存储，数据目录结构：data/{users,public_files,tasks,uploads}
- 支持conda环境运行

输出要求：
- 创建backend/目录下的完整项目结构
- 每个文件都要有完整的代码实现
- 代码要能直接运行（uvicorn app.main:app --reload）
- 提供详细的文件说明

参考文档：系统设计文档.md、requirements.txt
```

---

## 🎨 第二阶段：前端基础架构

### 提示词2-1：创建React前端基础架构

```
请根据我的文档帮我创建React前端项目的完整基础架构。

具体需求：
1. 按照系统设计文档.md中的前端页面结构创建完整项目
2. 配置React Router路由系统，包含所有页面路由
3. 设置Zustand状态管理，创建用户状态和任务状态store
4. 创建Axios API服务层，对应后端所有接口
5. 实现基础的布局组件（导航栏、侧边栏、内容区域）
6. 创建所有页面组件的基础结构（暂时显示页面标题即可）
7. 配置Ant Design主题和基本样式

技术要求：
- 使用package.json中的所有依赖包
- 严格遵循系统设计文档.md中的前端页面结构
- 实现响应式布局设计
- 支持TypeScript类型检查

输出要求：
- 创建frontend/src/目录下的完整项目结构
- 每个组件都要有完整的代码实现
- 代码要能直接运行（npm run dev）
- 提供详细的组件说明

参考文档：系统设计文档.md、package.json、界面需求.md
```

---

## 🔐 第三阶段：用户认证系统

### 提示词3-1：实现后端用户认证功能

```
请帮我实现用户认证系统的完整后端功能。

具体需求：
1. 实现用户注册API（POST /api/auth/register）
2. 实现用户登录API（POST /api/auth/login）
3. 实现获取当前用户信息API（GET /api/auth/me）
4. 实现JWT Token生成和验证机制
5. 实现密码加密存储（bcrypt）
6. 实现基于角色的权限控制中间件
7. 实现用户数据的文件系统存储和管理

技术要求：
- 使用python-jose生成JWT Token
- 使用passlib进行密码加密
- 支持三种角色：super_admin、admin、annotator
- 用户数据存储在data/users/users.json文件中
- 实现完整的错误处理和数据验证

输出要求：
- 完整的认证相关代码实现
- 包含数据验证和错误处理
- 提供测试用的初始管理员账户创建
- 代码要能与前端基础架构集成

参考文档：系统设计文档.md中的认证接口和用户模型
```

### 提示词3-2：实现前端用户认证功能

```
请帮我实现用户认证系统的完整前端功能。

具体需求：
1. 实现登录页面组件，包含用户名/密码输入和登录按钮
2. 实现注册页面组件，包含用户信息输入和注册按钮
3. 实现用户状态管理（Zustand store），包含登录状态、用户信息、Token管理
4. 实现路由守卫，保护需要认证的页面
5. 实现自动Token刷新机制
6. 实现登出功能
7. 实现基于角色的UI权限控制

技术要求：
- 使用Ant Design的Form组件
- 使用React Router进行路由管理
- Token存储在localStorage中
- 实现完整的错误处理和用户提示
- 支持记住登录状态

输出要求：
- 完整的认证相关组件和状态管理
- 美观的登录/注册界面
- 完整的用户体验流程
- 代码要能与后端认证API集成

参考文档：系统设计文档.md、界面需求.md中的认证相关需求
```

---

## 📁 第四阶段：文件管理功能

### 提示词4-1：实现后端文件管理功能

```
请帮我实现文件管理系统的完整后端功能。

具体需求：
1. 实现文件列表API（GET /api/files），支持按类型筛选（documents/templates/exports）
2. 实现文件上传API（POST /api/files/upload），支持多文件上传
3. 实现文件下载API（GET /api/files/{file_id}/download）
4. 实现文件删除API（DELETE /api/files/{file_id}）
5. 实现文件预览API（GET /api/files/{file_id}/preview）
6. 实现文件类型验证（documents只能是json/jsonl，templates只能是py）
7. 实现基于角色的文件操作权限控制

技术要求：
- 使用python-multipart处理文件上传
- 文件存储在data/public_files/目录下
- 实现文件元数据管理（文件名、大小、上传者、上传时间等）
- 支持Python模板文件的语法验证
- 实现完整的错误处理和权限检查

输出要求：
- 完整的文件管理相关代码实现
- 包含文件验证和权限控制
- 支持大文件上传和流式下载
- 代码要能处理并发文件操作

参考文档：系统设计文档.md中的文件管理接口、产品需求.md中的公共文件库需求
```

### 提示词4-2：实现前端文件管理功能

```
请帮我实现文件管理系统的完整前端功能。

具体需求：
1. 实现文件库页面，支持三个标签页（文档文件、模板文件、导出文件）
2. 实现文件上传组件，支持拖拽上传和点击上传
3. 实现文件列表展示，包含文件名、大小、上传时间、操作按钮
4. 实现文件预览功能（JSON文件和Python文件的代码高亮显示）
5. 实现文件下载和删除功能
6. 实现文件搜索和排序功能
7. 实现基于角色的操作权限控制

技术要求：
- 使用Ant Design的Upload、Table、Modal等组件
- 使用Monaco Editor显示代码预览
- 实现文件上传进度显示
- 支持批量操作（批量下载、批量删除）
- 实现完整的错误处理和用户提示

输出要求：
- 完整的文件管理相关组件
- 美观的文件管理界面
- 良好的用户交互体验
- 代码要能与后端文件API集成

参考文档：界面需求.md中的文件上传校验需求、产品需求.md中的公共文件库需求
```

---

## 📋 第五阶段：任务管理功能

### 提示词5-1：实现后端任务管理功能

```
请帮我实现任务管理系统的完整后端功能。

具体需求：
1. 实现任务列表API（GET /api/tasks），支持状态筛选和分页
2. 实现创建任务API（POST /api/tasks），包含文档选择和模板配置
3. 实现任务详情API（GET /api/tasks/{task_id}）
4. 实现更新任务API（PUT /api/tasks/{task_id}），支持修改分配人员
5. 实现删除任务API（DELETE /api/tasks/{task_id}）
6. 实现任务进度计算和状态管理
7. 实现基于角色的任务操作权限控制

技术要求：
- 任务数据存储在data/tasks/目录下
- 支持任务状态流转（pending -> in_progress -> completed）
- 实现模板文件的解析和验证
- 计算任务完成进度（已完成文档数/总文档数）
- 实现完整的数据验证和错误处理

输出要求：
- 完整的任务管理相关代码实现
- 包含任务状态管理和进度计算
- 支持复杂的任务查询和筛选
- 代码要能处理任务的完整生命周期

参考文档：系统设计文档.md中的任务管理接口、产品需求.md中的任务管理需求
```

### 提示词5-2：实现前端任务管理功能

```
请帮我实现任务管理系统的完整前端功能。

具体需求：
1. 实现任务列表页面，显示任务卡片和筛选功能
2. 实现创建任务表单，包含基本信息和文档/模板选择
3. 实现任务详情页面，显示任务信息、文档列表、进度统计
4. 实现任务编辑功能，支持修改任务信息和重新分配
5. 实现任务状态管理和进度可视化
6. 实现任务搜索和高级筛选功能
7. 实现基于角色的任务操作权限控制

技术要求：
- 使用Ant Design的Card、Form、Table、Progress等组件
- 实现任务状态的颜色标识和图标显示
- 支持任务的批量操作
- 实现实时的进度更新
- 提供良好的用户交互反馈

输出要求：
- 完整的任务管理相关组件
- 直观的任务管理界面
- 流畅的任务创建和编辑流程
- 代码要能与后端任务API集成

参考文档：界面需求.md中的任务管理需求、产品需求.md中的任务管理需求
```

---

## ✏️ 第六阶段：标注功能

### 提示词6-1：实现后端标注功能

```
请帮我实现标注系统的完整后端功能。

具体需求：
1. 实现获取文档标注数据API（GET /api/tasks/{task_id}/documents/{document_id}/annotation）
2. 实现保存标注数据API（POST /api/tasks/{task_id}/documents/{document_id}/annotation）
3. 实现提交文档标注API（POST /api/tasks/{task_id}/documents/{document_id}/submit）
4. 实现Python模板解析，动态生成表单字段配置
5. 实现标注数据验证，根据模板规则验证数据
6. 实现标注历史记录和版本管理
7. 实现自动保存机制

技术要求：
- 标注数据存储在data/tasks/{task_id}/annotations/目录下
- 支持模板文件的动态解析和字段生成
- 实现数据验证（必填、类型、长度等）
- 支持复杂数据类型（array、object）的处理
- 实现完整的错误处理和数据完整性检查

输出要求：
- 完整的标注功能相关代码实现
- 包含模板解析和数据验证
- 支持复杂的标注数据结构
- 代码要能处理大量标注数据

参考文档：系统设计文档.md中的标注功能接口、文档验证模板指南.md、标注任务详情.md
```

### 提示词6-2：实现前端标注功能

```
请帮我实现标注系统的完整前端功能。

具体需求：
1. 实现标注工作台页面，采用三栏布局（文档列表、文档内容、标注表单）
2. 实现动态表单生成，根据模板配置自动生成标注表单
3. 实现文档内容展示，使用Monaco Editor显示JSON内容
4. 实现标注表单，支持所有字段类型（string、text、number、select等）
5. 实现自动保存和手动保存功能
6. 实现文档间的快速切换和进度显示
7. 实现标注数据的实时验证和错误提示

技术要求：
- 使用Monaco Editor显示文档内容
- 使用Ant Design的Form组件构建动态表单
- 实现表单字段的联动和条件显示
- 支持复杂数据类型的编辑（array、object）
- 实现完整的用户交互和反馈

输出要求：
- 完整的标注工作台组件
- 直观的三栏布局界面
- 流畅的标注操作体验
- 代码要能与后端标注API集成

参考文档：标注任务详情.md中的页面设计、文档验证模板指南.md中的字段类型
```

---

## 🔍 第七阶段：复审功能

### 提示词7-1：实现后端复审功能

```
请帮我实现复审系统的完整后端功能。

具体需求：
1. 实现获取复审数据API（GET /api/tasks/{task_id}/documents/{document_id}/review）
2. 实现提交复审结果API（POST /api/tasks/{task_id}/documents/{document_id}/review）
3. 实现数据对比算法，计算原始数据和标注数据的差异
4. 实现复审状态管理（pending、approved、rejected、modified）
5. 实现复审意见和修改记录的存储
6. 实现复审权限控制（只有管理员可以复审）
7. 实现复审历史记录管理

技术要求：
- 复审数据存储在data/tasks/{task_id}/reviews/目录下
- 实现深度数据对比算法，支持嵌套对象和数组
- 支持复审结果的版本管理
- 实现完整的复审流程状态控制
- 提供详细的差异分析结果

输出要求：
- 完整的复审功能相关代码实现
- 包含数据对比和状态管理
- 支持复杂的复审流程
- 代码要能处理大量复审数据

参考文档：系统设计文档.md中的复审功能接口、产品需求.md中的复审功能需求
```

### 提示词7-2：实现前端复审功能

```
请帮我实现复审系统的完整前端功能。

具体需求：
1. 实现复审页面，显示原始数据、标注数据和差异对比
2. 实现数据对比视图，高亮显示数据变更（增加、修改、删除）
3. 实现复审操作界面，包含通过、拒绝、修改按钮
4. 实现复审意见输入和历史记录显示
5. 实现修改功能，允许复审者直接修改标注数据
6. 实现复审进度统计和状态展示
7. 实现复审结果的导出预览

技术要求：
- 使用差异对比组件显示数据变更
- 使用Ant Design的Comment组件显示复审意见
- 实现数据的可视化对比展示
- 支持复审数据的在线编辑
- 提供清晰的复审操作流程

输出要求：
- 完整的复审相关组件
- 直观的数据对比界面
- 流畅的复审操作体验
- 代码要能与后端复审API集成

参考文档：界面需求.md中的复审功能需求、产品需求.md中的复审功能需求
```

---

## 📤 第八阶段：数据导出功能

### 提示词8-1：实现后端数据导出功能

```
请帮我实现数据导出系统的完整后端功能。

具体需求：
1. 实现导出任务结果API（POST /api/tasks/{task_id}/export）
2. 实现下载导出文件API（GET /api/exports/{export_id}/download）
3. 实现多种导出格式支持（JSON、JSONL、CSV）
4. 实现导出配置选项（包含原始数据、包含元数据等）
5. 实现异步导出处理，支持大数据量导出
6. 实现导出文件的自动清理机制
7. 实现导出权限控制和日志记录

技术要求：
- 导出文件存储在data/public_files/exports/目录下
- 支持流式数据处理，避免内存溢出
- 实现导出任务的状态管理（pending、processing、completed、failed）
- 支持自定义导出字段和格式
- 实现完整的错误处理和重试机制

输出要求：
- 完整的数据导出相关代码实现
- 包含多格式导出和异步处理
- 支持大数据量的高效导出
- 代码要能处理复杂的导出需求

参考文档：系统设计文档.md中的数据导出接口、产品需求.md中的导出需求
```

### 提示词8-2：实现前端数据导出功能

```
请帮我实现数据导出系统的完整前端功能。

具体需求：
1. 实现导出配置页面，包含格式选择和选项配置
2. 实现导出进度显示，实时更新导出状态
3. 实现导出历史记录，显示所有导出任务
4. 实现导出文件的下载和管理功能
5. 实现导出预览功能，显示导出数据样例
6. 实现批量导出功能，支持多任务同时导出
7. 实现导出结果的统计和分析

技术要求：
- 使用Ant Design的Progress组件显示导出进度
- 实现导出配置的表单验证
- 支持导出任务的取消和重试
- 提供导出结果的预览和验证
- 实现完整的用户交互反馈

输出要求：
- 完整的数据导出相关组件
- 直观的导出配置界面
- 清晰的导出进度和结果展示
- 代码要能与后端导出API集成

参考文档：产品需求.md中的导出文件需求、界面需求.md中的相关UI需求
```

---

## 📝 使用说明

### 开发流程
1. **按顺序执行**：严格按照1-1 → 1-2 → 2-1 → 2-2 的顺序进行
2. **测试验证**：每个阶段完成后进行功能测试
3. **文档更新**：根据实际实现情况更新相关文档
4. **代码优化**：在功能完成后进行代码优化和重构

### 注意事项
- 每个提示词都要明确指出参考的文档
- 确保前后端接口的一致性
- 重视错误处理和用户体验
- 保持代码的可维护性和扩展性

### 测试建议
- 使用Postman测试后端API
- 使用浏览器测试前端功能
- 进行集成测试验证前后端协作
- 测试不同角色的权限控制

---

**重要提醒**：每次开发前请确保已激活conda环境：`conda activate annotator` 