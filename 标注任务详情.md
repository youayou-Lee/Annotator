# 标注任务详情设计文档

## 1. 页面概述

标注任务详情页面是用户进行文档标注的核心工作区域。该页面需要提供直观、高效的界面，支持用户对文档进行标注，修改原有文档的内容并同步到文件内容中。并在不同文档间快速切换。页面设计需要考虑不同类型字段的编辑体验，以及复杂嵌套结构的展示和编辑方式。

### 1.1 详细需求
根据创建任务时提供的

## 2. 页面布局

### 2.1 总体布局

页面采用三栏布局：

```
+------------------------------------------------------+
| 导航栏                                                |
+------------------------------------------------------+
|              |                      |                 |
|  文档列表区域  |    文档内容区域      |   标注表单区域   |
|              |                      |                 |
|              |                      |                 |
|              |                      |                 |
|              |                      |                 |
|              |                      |                 |
+------------------------------------------------------+
|                  底部状态栏 & 操作按钮                  |
+------------------------------------------------------+
```

### 2.2 各区域说明

1. **导航栏**：
   - 显示当前任务名称
   - 面包屑导航
   - 返回任务列表按钮
   - 任务进度统计

2. **文档列表区域**：
   - 任务包含的所有文档列表
   - 显示文档标注状态（未开始、进行中、已完成）
   - 支持搜索和排序
   - 可调整宽度或折叠

3. **文档内容区域**：
   - 以只读方式显示原始文档内容
   - JSON格式化展示
   - 语法高亮
   - 可折叠节点
   - 支持搜索
   - 点击内容可以定位到对应的标注表单字段

4. **标注表单区域**：
   - 根据模板动态生成表单
   - 支持不同类型的输入控件（文本框、下拉框、复选框等）
   - 嵌套数据结构的展示和编辑
   - 字段验证和错误提示
   - 支持快捷键操作

5. **底部状态栏 & 操作按钮**：
   - 显示当前保存状态
   - 保存按钮（自动保存/手动保存）
   - 提交按钮（完成标注）
   - 下一个/上一个文档按钮
   - 标注进度指示

## 3. 功能详细说明

### 3.1 文档列表功能

1. **列表项展示**：
   - 显示文档名称/ID
   - 标注状态图标（未开始/进行中/已完成）
   - 最后修改时间
   - 完成百分比

2. **交互功能**：
   - 点击切换当前文档
   - 右键菜单（标记为已完成、复制ID等）
   - 拖拽调整顺序
   - 过滤条件（按状态、类型等）

### 3.2 文档内容展示

1. **JSON展示**：
   - 使用Monaco Editor以只读模式展示
   - 语法高亮和格式化
   - 支持折叠/展开节点
   - 搜索功能

2. **联动功能**：
   - 当在标注表单中编辑时，对应JSON节点高亮
   - 点击JSON节点定位到表单对应字段
   - 支持分屏对比视图

### 3.3 标注表单功能

1. **动态表单生成**：
   - 根据模板文件定义自动生成表单结构
   - 支持嵌套对象和数组
   - 针对不同数据类型提供适当的编辑器

2. **字段类型支持**：
   - 基本类型（字符串、数字、布尔值）
   - 数组类型（支持添加/删除/排序项）
   - 对象类型（支持展开/折叠）
   - 枚举类型（下拉选择）
   - 特殊类型（日期、颜色、标签等）

3. **数据验证**：
   - 实时验证数据格式
   - 错误提示与可视化
   - 必填字段检查
   - 自定义验证规则支持

4. **用户体验**：
   - 支持键盘导航和快捷键
   - 自动保存（定时/失焦）
   - 修改历史记录
   - 支持撤销/重做

### 3.4 底部操作区

1. **保存功能**：
   - 实时自动保存
   - 手动保存按钮
   - 保存状态指示

2. **导航功能**：
   - 上一个/下一个文档按钮
   - 快捷键支持

3. **提交功能**：
   - 提交当前文档（标记为已完成）
   - 提交前验证

4. **状态显示**：
   - 当前文档完成进度
   - 整体任务进度
   - 最后保存时间

## 4. 特殊字段处理

### 4.1 基本类型处理

- **字符串**：单行/多行文本框
- **数字**：数字输入框（支持范围限制）
- **布尔值**：开关/复选框
- **枚举**：下拉选择/单选按钮组




## 9. 技术实现

### 9.1 前端技术

- **React**：用于构建用户界面
- **Ant Design**：UI组件库
- **Monaco Editor**：代码编辑器
- **JSON Schema**：表单验证
- **React Query**：数据获取和缓存
- **Zustand**：状态管理

### 9.2 数据流

1. 页面加载时获取：
   - 任务基本信息
   - 文档列表
   - 模板定义

2. 切换文档时：
   - 获取文档内容
   - 获取已有标注数据
   - 生成标注表单

3. 编辑标注时：
   - 实时验证
   - 自动保存
   - 更新进度

4. 提交文档时：
   - 最终验证
   - 保存结果
   - 更新状态

